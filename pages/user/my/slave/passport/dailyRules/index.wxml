<!--pages/user/my/slave/passport/dailyRules/index.wxml-->
<view class="drawer-mask" wx:if="{{showPassportDrawer}}" bindtap="showClosePassportDrawer"></view>
<view class="drawer {{showPassportDrawer ? 'drawer-show' : ''}}">
  <view class="drawer-header">
    <view class="drawer-title">通行证</view>
    <view class="drawer-close" bindtap="showClosePassportDrawer">×</view>
  </view>
  <view class="drawer-content" wx:if="{{passportStep === 1}}">
    <view class="form-group">
      <!-- 严管 -->
      <view class="form-title" style="margin-top: 0;">阳具管理</view>
      <view class="form-row">
        <view class="form-item">
          <view class="account-title">是否佩戴太监锁</view>
          <view class="account-select">
            <view class="{{passportData.is_locked == 1 ? 'active' : ''}}" bindtap="handleLockChange" data-value="1">
              是
            </view>
            <view class="{{passportData.is_locked == 0 ? 'active' : ''}}" bindtap="handleLockChange" data-value="0">
              否
            </view>
          </view>
        </view>
        <view class="form-item">
          <view class="account-title">是否遵守触碰条例</view>
          <view class="account-select">
            <view class="{{passportData.touch_count == 0 ? 'active' : 'error'}}" bindtap="changeTouchCountStatus">
              {{passportData.touch_count == 0 ? '遵守' : '违反'}}
            </view>
            <view class="account-input">
              <input type="number" disabled="{{passportData.touch_count == 0}}" value="{{passportData.touch_count}}" bindinput="handleTouchInput" />
            </view>
          </view>
        </view>
      </view>
      <!-- 管控 -->
      <view class="form-title">排泄管控</view>
      <view class="form-row">
        <view class="form-item">
          <view class="account-title">允许次数 3</view>
          <view class="account-select">
            <view class="{{passportData.excretion_count == 0 ? 'active' : 'error'}}" bindtap="handleWaterCountStatus">
              {{passportData.excretion_count == 0 ? '控制' : '违规'}}
            </view>
            <view class="account-input">
              <input type="number" disabled="{{passportData.excretion_count == 0}}" value="{{passportData.excretion_count}}" bindinput="handleWaterCountInput" />
            </view>
          </view>
        </view>
        <view class="form-item">
          <view class="account-title">饮水量</view>
          <view class="account-select">
            <view class="{{passportData.water_completed? 'active' : 'error'}}" bindtap="handleWaterStatus">
              {{passportData.water_completed ? '合格' : '不合格'}}
            </view>
            <view class="account-input">
              <input type="number" disabled value="{{passportData.water_intake}}" />
            </view>
          </view>
        </view>
      </view>
      <!-- 汇报 -->
      <view class="form-title">汇报性欲</view>
      <view class="form-row" style="margin-bottom: 0;">
        <view class="form-item">
          <view class="account-select-three">
            <view wx:for="{{sexStatus}}" wx:key="name" class="{{item.name == passportData.libido_status ? 'active' : ''}}" bindtap="handleStatusChange" data-index="{{index}}">
              {{item.name}}
            </view>
          </view>
          <view class="account-input status-text">
            <view>{{passportData.status_text}}</view>
          </view>
        </view>
      </view>
    </view>
  </view>
  <view class="drawer-content" wx:if="{{passportStep === 2}}">
    <view class="form-group">
      <!-- 每日任务 -->
      <view class="form-title" style="margin-top: 0;">每日任务</view>
      <view class="form-row">
        <view class="form-item" bindtap="handleDailyTaskChange">
          <view class="account-input" style="border-radius: 12rpx 12rpx 0 0 ;border-bottom: 2rpx #71717a solid;">
            <view style="font-size: 32rpx;">{{passportData.daily_task_title}}</view>
          </view>
          <view class="account-textarea">
            <view>{{passportData.daily_task_content}}</view>
          </view>
          <view class="status-emoji">
            <image wx:if="{{!passportData.daily_task_completed}}" src="/static/image/incomplete.png" mode="aspectFill"></image>
            <image wx:else src="/static/image/complete.png" mode="aspectFill"></image>
          </view>
        </view>
      </view>
      <!-- 额外任务 -->
      <view class="form-title">额外任务</view>
      <view class="form-row">
        <view class="form-item" bindtap="handleExtraTaskChange">
          <view class="account-input" style="border-radius: 12rpx 12rpx 0 0 ;border-bottom: 2rpx #71717a solid;">
            <view style="font-size: 32rpx;">{{passportData.extra_task_title}}</view>
          </view>
          <view class="account-textarea">
            <view>{{passportData.extra_task_content}}</view>
          </view>
          <view class="status-emoji">
            <image wx:if="{{!passportData.extra_task_completed}}" src="/static/image/incomplete.png" mode="aspectFill"></image>
            <image wx:else src="/static/image/complete.png" mode="aspectFill"></image>
          </view>
        </view>
      </view>
    </view>
  </view>
  <view class="drawer-content" wx:if="{{passportStep === 3}}">
    <view class="form-group">
      <!-- 其他工具 -->
      <view class="form-title" style="margin-top: 0;">其他工具</view>
      <view class="form-row">
        <view class="form-item">
          <view class="account-input">
            <picker mode="selector" range="{{toolsList}}" bindchange="handleToolsChange">
              <view class="{{passportData.other_tools ? '' : 'placeholderClass'}}">
                {{passportData.other_tools || '无'}}
              </view>
            </picker>
          </view>
        </view>
      </view>
      <!-- 违规行为 -->
      <view class="form-title">犯错行为</view>
      <view class="form-row" >
        <view class="form-item">
          <view class="account-input">
            <input type="text" value="{{passportData.violation}}" bindinput="handleViolationInput" placeholder="无" />
          </view>
        </view>
      </view>
    </view>
  </view>
  <view class="btn-group" style="padding: 32rpx;margin-top: 0;">
    <view class="wx-login-btn" bindtap="toNextSteps">
      {{passportStep !== 3 ? '下一步' : '提交并关闭'}}
    </view>
    <view class="otherlogin" bindtap="showClosePassportDrawer">取消</view>
  </view>
</view>